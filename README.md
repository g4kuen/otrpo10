
# Лабораторная работа 10: Time Series Database (Prometheus)

## Описание

Проект представляет собой приложение-экспортер, которое собирает метрики операционной системы (использование процессора, оперативной памяти и дискового пространства) и предоставляет их для Prometheus.  

## Функциональность

Экспортер собирает следующие метрики:  
1. **Использование процессора** (ядра процессоров).  
2. **Использование оперативной памяти** (общий объём и используемый).  
3. **Использование дискового пространства** (общий объём и используемый).  

Метрики доступны на корневом пути (`/`) в формате, поддерживаемом Prometheus.

## Используемые технологии

- Prometheus
- PromQL
- Python 

## Установка

1. Клонируйте репозиторий:
   ```bash
   git clone https://github.com/g4kuen/otrpo10.git
   ```
2. Установите зависимости:
   ```bash
   pip install -r requirements.txt
   ```

## Настройка

1. Определите переменные окружения .env:  
   - `EXPORTER_HOST` — хост, на котором работает экспортер (например, `localhost`).  
   - `EXPORTER_PORT` — порт, на котором работает экспортер (например, `8080`).

## Запуск

1. Убедитесь, что все переменные окружения определены.  
2. Запустите приложение:  
   ```bash
   python exporter.py
   ```
3. Перейдите по адресу:  
   ```plaintext
   http://<EXPORTER_HOST>:<EXPORTER_PORT>/
   ```

## Запросы на PromQL

### Использование процессоров
```promql
100 - (avg by (instance) (irate(node_cpu_seconds_total{mode="idle"}[5m])) * 100)
```

### Использование памяти
Общее количество памяти:  
```promql
node_memory_MemTotal_bytes
```
Используемая память:  
```promql
node_memory_MemTotal_bytes - node_memory_MemAvailable_bytes
```

### Использование дискового пространства
Общий объём дисков:  
```promql
node_filesystem_size_bytes
```
Используемый объём:  
```promql
node_filesystem_size_bytes - node_filesystem_free_bytes
```
